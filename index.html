<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Handy ‚Äî AI-Powered Home Diagnostics</title>
<meta name="description" content="Handy prototype ‚Äî AI-powered home issue diagnosis and professional marketplace.">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@400;500;600;700&family=Karla:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<style>
  *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
  html, body { height: 100%; overflow: hidden; }
  body {
    font-family: 'Karla', 'Helvetica Neue', sans-serif;
    background: #E8E4DC;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    -webkit-tap-highlight-color: transparent;
  }
  @keyframes rise { from { opacity:0; transform:translateY(18px); } to { opacity:1; transform:translateY(0); } }
  ::-webkit-scrollbar { display: none; }
  input::placeholder, textarea::placeholder { color: #9E9A90; }

  /* ‚îÄ‚îÄ Phone frame ‚îÄ‚îÄ */
  .phone {
    width: 390px; height: 760px; background: #F4F1EB; border-radius: 40px;
    overflow: hidden; position: relative;
    box-shadow: 0 0 0 1px rgba(0,0,0,0.04), 0 24px 80px rgba(0,0,0,0.08);
  }
  .status-bar {
    height: 52px; display: flex; justify-content: space-between; align-items: flex-end;
    padding: 0 28px 8px; font-size: 13px; font-weight: 500; color: #2C2C28;
  }
  .content-scroll {
    height: calc(100% - 52px - 68px); overflow-y: auto; overflow-x: hidden;
  }
  .bottom-nav {
    position: absolute; bottom: 0; left: 0; right: 0; height: 68px;
    background: #FFFFFF; border-top: 1px solid #E8E4DC;
    display: flex; justify-content: space-around; align-items: center; padding-bottom: 6px;
  }
  .nav-item {
    display: flex; flex-direction: column; align-items: center; gap: 3px;
    cursor: pointer; padding: 4px 14px; transition: all 0.2s;
  }
  .nav-item span { font-size: 9px; font-weight: 500; letter-spacing: 0.4px; }
  .nav-item.active { color: #5C6B3C; }
  .nav-item:not(.active) { color: #C4C0B6; }
  .scan-btn {
    width: 46px; height: 46px; border-radius: 13px; margin-top: -20px;
    background: #5C6B3C; display: flex; align-items: center; justify-content: center;
    box-shadow: 0 6px 20px rgba(92,107,60,0.25);
  }

  /* ‚îÄ‚îÄ Shared styles ‚îÄ‚îÄ */
  .screen { padding: 0 24px 100px; display: none; }
  .screen.active { display: block; }
  .serif { font-family: 'Cormorant Garamond', Georgia, serif; }
  .rise { animation: rise 0.55s cubic-bezier(0.22,1,0.36,1) both; }
  .card {
    background: #FFFFFF; border-radius: 14px; padding: 20px;
    border: 1px solid #E8E4DC; transition: border-color 0.25s;
  }
  .card-highlight { border-color: rgba(92,107,60,0.15); }
  .pill {
    padding: 7px 16px; border-radius: 100px; font-size: 11px; font-weight: 500;
    cursor: pointer; transition: all 0.25s; white-space: nowrap; letter-spacing: 0.3px;
    display: inline-block;
  }
  .pill.active { background: #5C6B3C; color: #fff; border: 1px solid #5C6B3C; }
  .pill:not(.active) { background: #FFFFFF; color: #9E9A90; border: 1px solid #DBD7CE; }
  .btn {
    padding: 15px 28px; border-radius: 12px; font-weight: 500; font-size: 13px;
    cursor: pointer; transition: all 0.2s; font-family: 'Karla', sans-serif;
    letter-spacing: 0.3px; display: flex; align-items: center; justify-content: center; gap: 8px;
    border: none; width: 100%;
  }
  .btn-primary { background: #5C6B3C; color: #fff; }
  .btn-primary:disabled { opacity: 0.4; cursor: default; }
  .btn-ghost { background: transparent; color: #6B6860; border: 1px solid #DBD7CE; }
  .badge {
    padding: 3px 12px; border-radius: 100px; font-size: 9px; font-weight: 500;
    letter-spacing: 0.8px; text-transform: uppercase;
  }
  .badge-urgent { background: rgba(181,74,59,0.08); color: #B54A3B; }
  .badge-moderate { background: rgba(192,144,64,0.08); color: #C09040; }
  .badge-low { background: rgba(90,138,94,0.08); color: #5A8A5E; }
  .avatar {
    width: 46px; height: 46px; border-radius: 10px; flex-shrink: 0;
    background: #5C6B3C; color: #fff; display: flex; align-items: center;
    justify-content: center; font-weight: 600; font-size: 14px;
  }
  .label {
    font-size: 10px; font-weight: 500; color: #9E9A90; display: block;
    margin-bottom: 8px; letter-spacing: 1.2px; text-transform: uppercase;
  }
  .back-row {
    display: flex; align-items: center; gap: 14px; padding: 18px 0 22px;
  }
  .back-btn {
    cursor: pointer; color: #6B6860; font-size: 14px; width: 34px; height: 34px;
    display: flex; align-items: center; justify-content: center;
    border-radius: 10px; border: 1px solid #DBD7CE; background: #FFFFFF;
  }
  .stars { color: #B09050; font-size: 11px; letter-spacing: 1px; }
  .stars-empty { color: #E8E4DC; }
  .verified {
    background: rgba(92,107,60,0.07); border: 1px solid rgba(92,107,60,0.14);
    border-radius: 4px; padding: 2px 7px; font-size: 8px; font-weight: 500;
    color: #5C6B3C; letter-spacing: 0.8px; text-transform: uppercase;
  }
  .progress-bar {
    background: #ECE8E0; border-radius: 100px; height: 4px; overflow: hidden;
  }
  .progress-fill {
    height: 100%; border-radius: 100px; background: #5C6B3C; transition: width 0.3s ease;
  }

  /* ‚îÄ‚îÄ Responsive: show without phone frame on small screens ‚îÄ‚îÄ */
  @media (max-width: 430px) {
    body { background: #F4F1EB; justify-content: flex-start; }
    .phone {
      width: 100%; height: 100vh; border-radius: 0;
      box-shadow: none;
    }
    .header-bar { display: none; }
  }

  /* ‚îÄ‚îÄ Desktop wrapper ‚îÄ‚îÄ */
  .page-wrapper {
    display: flex; flex-direction: column; align-items: center; gap: 20px; padding: 20px;
  }
  .header-bar {
    text-align: center; padding: 10px 0 0;
  }
  .header-bar h1 {
    font-family: 'Cormorant Garamond', Georgia, serif;
    font-size: 28px; font-weight: 700; color: #2C2C28;
  }
  .header-bar p { font-size: 13px; color: #9E9A90; margin-top: 4px; }
</style>
</head>
<body>

<div class="page-wrapper">
  <div class="header-bar">
    <h1>Handy</h1>
    <p>Interactive Prototype ‚Äî Tap through the app below</p>
  </div>

  <div class="phone" id="phone">
    <!-- Status Bar -->
    <div class="status-bar">
      <span style="letter-spacing:0.3px">9:41</span>
      <div style="display:flex;gap:6px;align-items:center">
        <div style="display:flex;gap:1.5px">
          <div style="width:3px;height:10px;background:#2C2C28;border-radius:1.5px"></div>
          <div style="width:3px;height:13px;background:#2C2C28;border-radius:1.5px"></div>
          <div style="width:3px;height:16px;background:#2C2C28;border-radius:1.5px"></div>
          <div style="width:3px;height:18px;background:#2C2C28;border-radius:1.5px"></div>
        </div>
        <svg width="14" height="10" viewBox="0 0 15 11"><path d="M7.5 3.5C9.4 3.5 11.1 4.3 12.3 5.5L14 3.8C12.3 2.1 10 1 7.5 1S2.7 2.1 1 3.8L2.7 5.5C3.9 4.3 5.6 3.5 7.5 3.5Z" fill="#2C2C28"/><circle cx="7.5" cy="10" r="1.5" fill="#2C2C28"/></svg>
        <div style="width:24px;height:11px;border-radius:3px;border:1px solid #9E9A90;position:relative;overflow:hidden">
          <div style="position:absolute;left:1px;top:1px;bottom:1px;width:16px;border-radius:2px;background:#5C6B3C"></div>
        </div>
      </div>
    </div>

    <!-- Scrollable Content -->
    <div class="content-scroll" id="content"></div>

    <!-- Bottom Nav -->
    <div class="bottom-nav">
      <div class="nav-item active" data-screen="home" onclick="navigate('home')">
        <svg width="19" height="19" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg>
        <span>Home</span>
      </div>
      <div class="nav-item" data-screen="directory" onclick="navigate('directory')">
        <svg width="19" height="19" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
        <span>Find</span>
      </div>
      <div class="nav-item" data-screen="scan" onclick="navigate('scan')">
        <div class="scan-btn">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#fff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"/><circle cx="12" cy="13" r="4"/>
          </svg>
        </div>
        <span>Scan</span>
      </div>
      <div class="nav-item" data-screen="issues" onclick="navigate('issues')">
        <svg width="19" height="19" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><line x1="8" y1="6" x2="21" y2="6"/><line x1="8" y1="12" x2="21" y2="12"/><line x1="8" y1="18" x2="21" y2="18"/><line x1="3" y1="6" x2="3.01" y2="6"/><line x1="3" y1="12" x2="3.01" y2="12"/><line x1="3" y1="18" x2="3.01" y2="18"/></svg>
        <span>Issues</span>
      </div>
      <div class="nav-item" data-screen="profile" onclick="navigate('profile')">
        <svg width="19" height="19" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
        <span>Profile</span>
      </div>
    </div>
  </div>
</div>

<script>
// ‚îÄ‚îÄ‚îÄ DATA ‚îÄ‚îÄ‚îÄ
const VENDORS = [
  { id:1, name:"Mike Chen Plumbing", rating:4.9, reviews:234, trade:"plumbing", time:"Under 1 hr", price:2, verified:true, dist:"2.3 mi", jobs:412, bio:"Master plumber with 15 years experience." },
  { id:2, name:"AquaGuard Solutions", rating:4.7, reviews:189, trade:"plumbing", time:"Under 2 hrs", price:3, verified:true, dist:"4.1 mi", jobs:287, bio:"Full-service plumbing. Water heaters, repiping." },
  { id:3, name:"QuickFix Plumbing", rating:4.5, reviews:98, trade:"plumbing", time:"Under 30 min", price:1, verified:false, dist:"1.1 mi", jobs:156, bio:"Fast emergency repairs. Fair pricing." },
  { id:4, name:"BrightSpark Electric", rating:4.9, reviews:276, trade:"electrical", time:"Under 1 hr", price:2, verified:true, dist:"3.2 mi", jobs:389, bio:"Panel upgrades, rewiring, EV chargers." },
  { id:5, name:"Watts Up Electrical", rating:4.6, reviews:142, trade:"electrical", time:"Under 2 hrs", price:1, verified:true, dist:"1.8 mi", jobs:201, bio:"Residential wiring and lighting." },
  { id:6, name:"CoolBreeze HVAC", rating:4.8, reviews:198, trade:"hvac", time:"Under 2 hrs", price:3, verified:true, dist:"4.5 mi", jobs:310, bio:"AC, furnace, duct cleaning. All brands." },
  { id:7, name:"ComfortZone Heating", rating:4.7, reviews:165, trade:"hvac", time:"Under 1 hr", price:2, verified:true, dist:"2.9 mi", jobs:248, bio:"24/7 emergency HVAC. Fast & reliable." },
  { id:8, name:"TopShield Roofing", rating:4.8, reviews:210, trade:"roofing", time:"Same day", price:3, verified:true, dist:"7.1 mi", jobs:445, bio:"Repair, replacement, inspections, gutters." },
  { id:9, name:"Fresh Coat Painters", rating:4.9, reviews:320, trade:"painting", time:"Same day", price:2, verified:true, dist:"3.4 mi", jobs:510, bio:"Interior, exterior, cabinets, staining." },
  { id:10, name:"GreenScape Design", rating:4.7, reviews:175, trade:"landscape", time:"Same day", price:2, verified:true, dist:"4.8 mi", jobs:292, bio:"Lawn, hardscape, irrigation, design." },
  { id:11, name:"NoBug Pest Control", rating:4.6, reviews:134, trade:"pest", time:"Under 2 hrs", price:1, verified:true, dist:"2.1 mi", jobs:367, bio:"Eco-friendly. Termites, rodents, ants." },
  { id:12, name:"Elite Home Services", rating:4.8, reviews:312, trade:"general", time:"Under 1 hr", price:3, verified:true, dist:"5.7 mi", jobs:523, bio:"Drywall, doors, trim, handyman." },
  { id:13, name:"ApplianceFix Pro", rating:4.7, reviews:156, trade:"appliance", time:"Under 1 hr", price:2, verified:true, dist:"3.6 mi", jobs:278, bio:"All major brands. Washers, fridges, ovens." },
];

const TRADES = [
  {id:"all",label:"All",em:"‚ú¶"},{id:"plumbing",label:"Plumbing",em:"üíß"},{id:"electrical",label:"Electrical",em:"‚ö°"},
  {id:"hvac",label:"HVAC",em:"üå°"},{id:"roofing",label:"Roofing",em:"üè†"},{id:"painting",label:"Painting",em:"üé®"},
  {id:"landscape",label:"Landscape",em:"üåø"},{id:"general",label:"General",em:"üîß"},{id:"pest",label:"Pest",em:"üêú"},
  {id:"appliance",label:"Appliance",em:"‚öôÔ∏è"},
];

const ISSUES = [
  {title:"Kitchen Faucet Leak",trade:"Plumbing",status:"done",date:"Jan 12",vendor:"Mike Chen",cost:"$185",urgency:"moderate"},
  {title:"Hallway Drywall Crack",trade:"General",status:"active",date:"Feb 3",vendor:"Elite Home",cost:"$340",urgency:"low"},
  {title:"HVAC Not Heating",trade:"HVAC",status:"pending",date:"Feb 15",vendor:null,cost:null,urgency:"urgent"},
];

// ‚îÄ‚îÄ‚îÄ STATE ‚îÄ‚îÄ‚îÄ
let currentScreen = 'home';
let selectedVendor = null;
let vendorFrom = 'matched';
let scanState = { mode: null, uploaded: false, desc: '', room: 'Kitchen' };
let dirState = { trade: 'all', search: '', sort: 'rating' };

// ‚îÄ‚îÄ‚îÄ HELPERS ‚îÄ‚îÄ‚îÄ
const $ = id => document.getElementById(id);
const content = () => $('content');

function stars(n) {
  return `<span class="stars">${'‚òÖ'.repeat(Math.round(n))}<span class="stars-empty">${'‚òÖ'.repeat(5-Math.round(n))}</span></span> <span style="font-size:12px;font-weight:500;color:#2C2C28;margin-left:2px">${n}</span>`;
}
function price(n) {
  return `<span style="color:#2C2C28">${'$'.repeat(n)}</span><span style="color:#C4C0B6">${'$'.repeat(3-n)}</span>`;
}
function initials(name) { return name.split(' ').map(w=>w[0]).slice(0,2).join(''); }
function badge(level) {
  return `<span class="badge badge-${level}">${level === 'moderate' ? 'Moderate' : level === 'urgent' ? 'Urgent' : 'Low'}</span>`;
}
function verifiedTag() { return `<span class="verified">Verified</span>`; }

function vendorCard(v, i, best) {
  const trade = TRADES.find(t=>t.id===v.trade);
  return `
    <div class="card rise" style="margin-bottom:10px;padding:18px;animation-delay:${0.03*i}s;cursor:pointer;${best?'border-color:rgba(92,107,60,0.15)':''}" onclick="showVendorDetail(${v.id})">
      ${best ? '<div style="font-size:9px;font-weight:500;color:#B09050;letter-spacing:1.2px;text-transform:uppercase;margin-bottom:10px">‚ú¶  Recommended</div>' : ''}
      <div style="display:flex;gap:14px">
        <div class="avatar">${initials(v.name)}</div>
        <div style="flex:1;min-width:0">
          <div style="display:flex;align-items:center;gap:7px;flex-wrap:wrap">
            <span style="font-size:14px;font-weight:500;color:#2C2C28">${v.name}</span>
            ${v.verified ? verifiedTag() : ''}
          </div>
          <div style="margin-top:4px">${stars(v.rating)} <span style="font-size:10px;color:#9E9A90">(${v.reviews})</span></div>
          <div style="display:flex;gap:10px;margin-top:7px;flex-wrap:wrap;align-items:center">
            ${trade ? `<span style="font-size:9px;font-weight:500;padding:2px 8px;border-radius:6px;background:rgba(92,107,60,0.07);color:#5C6B3C;letter-spacing:0.3px">${trade.em} ${trade.label}</span>` : ''}
            <span style="font-size:11px;color:#9E9A90">${v.time}</span>
            <span style="font-size:11px;color:#9E9A90">${v.dist}</span>
            <span style="font-size:11px">${price(v.price)}</span>
          </div>
        </div>
        <div style="display:flex;align-items:center;color:#C4C0B6;font-size:14px">‚Ä∫</div>
      </div>
    </div>`;
}

// ‚îÄ‚îÄ‚îÄ SCREENS ‚îÄ‚îÄ‚îÄ
function renderHome() {
  return `
    <div style="padding:0 24px 100px">
      <div class="rise" style="padding:22px 0 0;display:flex;justify-content:space-between;align-items:center">
        <div>
          <p style="font-size:11px;color:#9E9A90;letter-spacing:1.2px;text-transform:uppercase">Welcome back</p>
          <h1 class="serif" style="font-size:34px;font-weight:700;color:#2C2C28;margin-top:6px">Handy</h1>
        </div>
        <div style="width:40px;height:40px;border-radius:50%;background:#5C6B3C;display:flex;align-items:center;justify-content:center;color:#fff;font-weight:600;font-size:14px">B</div>
      </div>

      <div class="card rise" style="margin-top:24px;padding:32px 24px;cursor:pointer;position:relative;overflow:hidden;animation-delay:0.06s" onclick="navigate('scan')">
        <div style="position:absolute;top:0;right:0;width:200px;height:200px;background:radial-gradient(circle at top right,rgba(92,107,60,0.06) 0%,transparent 70%)"></div>
        <div style="position:relative">
          <div style="width:48px;height:48px;border-radius:12px;background:#5C6B3C;display:flex;align-items:center;justify-content:center;margin-bottom:18px">
            <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="#fff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"/><circle cx="12" cy="13" r="4"/></svg>
          </div>
          <h2 class="serif" style="font-size:24px;font-weight:600;color:#2C2C28;line-height:1.3">Describe Your Problem</h2>
          <p style="font-size:13px;color:#6B6860;margin-top:10px;line-height:1.6">Upload a photo, describe the issue, or both. Our AI will identify what's wrong and connect you with the right professional.</p>
        </div>
      </div>

      <div class="rise" style="display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-top:14px;animation-delay:0.12s">
        <div class="card" style="padding:20px 18px"><div class="serif" style="font-size:30px;font-weight:600;color:#2C2C28">3</div><div style="font-size:11px;color:#9E9A90;margin-top:4px">Active issues</div></div>
        <div class="card" style="padding:20px 18px"><div class="serif" style="font-size:30px;font-weight:600;color:#2C2C28">12</div><div style="font-size:11px;color:#9E9A90;margin-top:4px">Completed</div></div>
      </div>

      <div class="rise" style="margin-top:32px;animation-delay:0.18s">
        <div style="display:flex;justify-content:space-between;align-items:baseline;margin-bottom:16px">
          <h3 class="serif" style="font-size:20px;font-weight:600;color:#2C2C28">Recent Issues</h3>
          <span style="font-size:11px;color:#5C6B3C;font-weight:500;cursor:pointer" onclick="navigate('issues')">View all</span>
        </div>
        ${ISSUES.map((iss,i) => `
          <div class="card rise" style="margin-bottom:8px;padding:18px;animation-delay:${0.22+i*0.04}s">
            <div style="display:flex;justify-content:space-between;align-items:flex-start">
              <div>
                <span style="font-size:14px;font-weight:500;color:#2C2C28">${iss.title}</span>
                <div style="font-size:11px;color:#9E9A90;margin-top:5px">${iss.trade}  ¬∑  ${iss.date}${iss.vendor ? '  ¬∑  '+iss.vendor : ''}</div>
              </div>
              <div style="display:flex;flex-direction:column;align-items:flex-end;gap:6px">
                ${badge(iss.urgency)}
                ${iss.cost ? `<span style="font-size:13px;font-weight:500;color:#2C2C28">${iss.cost}</span>` : ''}
              </div>
            </div>
          </div>
        `).join('')}
      </div>

      <div class="rise" style="margin-top:32px;animation-delay:0.35s">
        <h3 class="serif" style="font-size:20px;font-weight:600;color:#2C2C28;margin-bottom:18px">How It Works</h3>
        ${[{n:"01",t:"Describe",d:"Upload a photo, write a description, or both"},{n:"02",t:"Diagnose",d:"AI identifies the problem and assesses urgency"},{n:"03",t:"Connect",d:"Receive bids from vetted local professionals"},{n:"04",t:"Resolve",d:"Track the repair through completion"}].map(s => `
          <div style="display:flex;gap:16px;align-items:baseline;margin-bottom:18px">
            <span style="font-size:10px;font-weight:500;color:#5C6B3C;letter-spacing:0.5px;width:20px">${s.n}</span>
            <div style="flex:1;border-bottom:1px solid #E8E4DC;padding-bottom:18px">
              <span class="serif" style="font-size:15px;font-weight:600;color:#2C2C28">${s.t}</span>
              <p style="font-size:12px;color:#9E9A90;margin-top:4px;line-height:1.5">${s.d}</p>
            </div>
          </div>
        `).join('')}
      </div>
    </div>`;
}

function renderScan() {
  const s = scanState;
  let html = `<div style="padding:0 24px 100px">
    <div class="back-row"><div class="back-btn" onclick="navigate('home')">‚Üê</div><h2 style="font-size:16px;font-weight:500;color:#2C2C28;letter-spacing:0.2px">New Issue</h2></div>`;

  if (!s.mode) {
    html += `<div class="rise"><p style="font-size:13px;color:#6B6860;margin:0 0 20px;line-height:1.6">How would you like to describe the issue?</p>`;
    [{id:"photo",icon:"üì∑",title:"Upload a Photo",sub:"Best for visible issues ‚Äî leaks, cracks, damage, stains"},
     {id:"describe",icon:"‚úèÔ∏è",title:"Describe It",sub:"Best for functional issues ‚Äî heater won't turn on, circuit tripping, strange noises"},
     {id:"both",icon:"üì∑ + ‚úèÔ∏è",title:"Photo & Description",sub:"Most accurate results ‚Äî show us and tell us what's happening"}
    ].forEach(opt => {
      html += `<div class="card" style="padding:20px;cursor:pointer;display:flex;gap:16px;align-items:center;margin-bottom:10px" onclick="setScanMode('${opt.id}')">
        <div style="width:48px;height:48px;border-radius:12px;background:#ECE8E0;display:flex;align-items:center;justify-content:center;font-size:20px;flex-shrink:0">${opt.icon}</div>
        <div style="flex:1"><div class="serif" style="font-size:14px;font-weight:600;color:#2C2C28">${opt.title}</div><div style="font-size:11px;color:#9E9A90;margin-top:3px;line-height:1.4">${opt.sub}</div></div>
        <span style="color:#C4C0B6;font-size:14px">‚Ä∫</span>
      </div>`;
    });
    html += `</div>`;
  } else {
    // Photo upload
    if (s.mode === 'photo' || s.mode === 'both') {
      html += `<div class="rise" style="margin-bottom:18px"><span class="label">Photo</span>`;
      if (!s.uploaded) {
        html += `<div style="border:1.5px dashed #DBD7CE;border-radius:16px;padding:48px 24px;text-align:center;cursor:pointer;background:#FFFFFF" onclick="uploadPhoto()">
          <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="#9E9A90" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" y1="3" x2="12" y2="15"/></svg>
          <p style="font-size:13px;font-weight:500;color:#2C2C28;margin:12px 0 3px">Tap to upload a photo</p>
          <p style="font-size:11px;color:#9E9A90">or take one with your camera</p>
        </div>`;
      } else {
        html += `<div style="border:1.5px dashed #5C6B3C;border-radius:16px;overflow:hidden;position:relative">
          <div style="width:100%;height:180px;background:linear-gradient(135deg,#E2DED5 0%,#ECE8E0 100%);display:flex;align-items:center;justify-content:center">
            <div style="text-align:center;color:#9E9A90"><span style="font-size:40px">üîß</span><div style="font-size:11px;margin-top:6px;font-style:italic">Leaking pipe under sink</div></div>
          </div>
          <span style="position:absolute;top:10px;right:10px;background:#5C6B3C;color:#fff;padding:4px 12px;border-radius:100px;font-size:9px;font-weight:500;letter-spacing:0.5px">‚úì Uploaded</span>
        </div>`;
      }
      html += `</div>`;
    }

    // Text description
    if (s.mode === 'describe' || s.mode === 'both') {
      const h = s.mode === 'describe' ? 160 : 100;
      html += `<div class="rise" style="margin-bottom:18px;animation-delay:${s.mode==='both'?'0.05s':'0s'}">
        <span class="label">Describe the issue</span>
        <textarea id="descInput" placeholder="Tell us what's happening. For example:\n\n&quot;My heater won't turn on. The thermostat is set to 72 but only cold air comes out.&quot;\n\n&quot;There's a buzzing sound from the electrical panel when I turn on the kitchen lights.&quot;" 
          style="width:100%;min-height:${h}px;padding:16px;border-radius:14px;border:1px solid #DBD7CE;font-size:13px;font-family:'Karla',sans-serif;color:#2C2C28;resize:vertical;box-sizing:border-box;outline:none;background:#FFFFFF;line-height:1.6"
          oninput="scanState.desc=this.value;updateScanButton()">${s.desc}</textarea>
      </div>`;
    }

    // Room
    const rooms = ["Kitchen","Bathroom","Bedroom","Living Room","Basement","Exterior","Garage","Roof","Whole Home"];
    html += `<div class="rise" style="margin-bottom:18px;animation-delay:${s.mode==='both'?'0.1s':'0.05s'}">
      <span class="label">Location in home</span>
      <div style="display:flex;gap:6px;flex-wrap:wrap">
        ${rooms.map(r => `<span class="pill ${s.room===r?'active':''}" onclick="setScanRoom('${r}')">${r}</span>`).join('')}
      </div>
    </div>`;

    // Analyze button
    const canSubmit = s.uploaded || s.desc.trim().length > 10;
    html += `<div class="rise" style="margin-top:4px;animation-delay:${s.mode==='both'?'0.15s':'0.1s'}">
      <button class="btn btn-primary" id="analyzeBtn" ${canSubmit?'':'disabled'} onclick="startAnalysis()">Analyze with AI</button>
      <div style="text-align:center;margin-top:12px;cursor:pointer" onclick="resetScanMode()">
        <span style="font-size:12px;color:#9E9A90;font-weight:500">‚Üê Change input method</span>
      </div>
    </div>`;
  }

  html += `</div>`;
  return html;
}

function renderAnalyzing() {
  return `<div style="padding:0 24px 100px">
    <div class="back-row"><div class="back-btn" onclick="navigate('scan')">‚Üê</div><h2 style="font-size:16px;font-weight:500;color:#2C2C28">Analyzing...</h2></div>
    <div class="rise" style="margin-top:32px;text-align:center">
      <div class="progress-bar" style="margin-bottom:16px"><div class="progress-fill" id="progressBar" style="width:0%"></div></div>
      <p style="font-size:12px;color:#9E9A90;font-weight:400;letter-spacing:0.3px" id="progressLabel">Examining your input...</p>
    </div>
  </div>`;
}

function renderDiagnosis() {
  return `<div style="padding:0 24px 100px">
    <div class="back-row"><div class="back-btn" onclick="navigate('scan')">‚Üê</div><h2 style="font-size:16px;font-weight:500;color:#2C2C28;letter-spacing:0.2px">Diagnosis</h2></div>
    <div class="card rise" style="padding:0;overflow:hidden">
      <div style="padding:22px 22px 0">
        <div style="display:flex;justify-content:space-between;align-items:flex-start">
          <div>
            <p style="font-size:9px;font-weight:500;color:#9E9A90;margin-bottom:6px;letter-spacing:1.2px;text-transform:uppercase">Issue Identified</p>
            <h3 class="serif" style="font-size:22px;font-weight:600;color:#2C2C28">Leaking Pipe Joint</h3>
          </div>
          ${badge('moderate')}
        </div>
      </div>
      <div style="padding:16px 22px 22px">
        <div style="display:flex;align-items:center;gap:10px;margin-bottom:20px">
          <div class="progress-bar" style="flex:1"><div class="progress-fill" style="width:92%"></div></div>
          <span style="font-size:11px;font-weight:500;color:#5C6B3C">92% confidence</span>
        </div>
        <div style="background:#F4F1EB;border-radius:12px;padding:18px;margin-bottom:16px">
          <p style="font-size:13px;color:#6B6860;line-height:1.7"><span style="color:#2C2C28;font-weight:500">Compression fitting leak</span> at a pipe joint under your kitchen sink. The corrosion pattern and water staining suggest this has been slowly leaking for several weeks. Standard ¬Ω" copper-to-PVC transition joint.</p>
        </div>
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:8px;margin-bottom:16px">
          ${[{l:"Category",v:"Plumbing"},{l:"Estimated Cost",v:"$120 ‚Äì $280"},{l:"Typical Fix",v:"1 ‚Äì 2 hours"},{l:"DIY Difficulty",v:"Moderate"}].map(d => `
            <div style="background:#F4F1EB;border-radius:10px;padding:12px 14px">
              <div style="font-size:9px;color:#9E9A90;font-weight:500;text-transform:uppercase;letter-spacing:0.8px">${d.l}</div>
              <div style="font-size:14px;font-weight:500;color:#2C2C28;margin-top:4px">${d.v}</div>
            </div>`).join('')}
        </div>
        <div style="background:rgba(192,144,64,0.08);border-radius:12px;padding:16px;display:flex;gap:12px;align-items:flex-start">
          <span style="color:#C09040;font-size:14px;flex-shrink:0;margin-top:1px">‚ö†</span>
          <div>
            <p style="font-size:11px;font-weight:600;color:#C09040;margin-bottom:4px;letter-spacing:0.3px">Recommendation</p>
            <p style="font-size:12px;color:#6B6860;line-height:1.6">Place a bucket underneath and schedule a plumber within 1‚Äì2 weeks. Left untreated, this could lead to water damage or mold growth.</p>
          </div>
        </div>
      </div>
    </div>
    <div class="rise" style="margin-top:18px;display:flex;flex-direction:column;gap:8px;animation-delay:0.1s">
      <button class="btn btn-primary" onclick="navigate('matched')">Find a Professional</button>
      <button class="btn btn-ghost">Ask a Follow-Up</button>
    </div>
  </div>`;
}

function renderMatched() {
  const plumbers = VENDORS.filter(v => v.trade === 'plumbing');
  return `<div style="padding:0 24px 100px">
    <div class="back-row"><div class="back-btn" onclick="navigate('diagnosis')">‚Üê</div><h2 style="font-size:16px;font-weight:500;color:#2C2C28">Available Professionals</h2></div>
    <p style="font-size:11px;color:#9E9A90;margin:-14px 0 18px">${plumbers.length} plumbers in your area</p>
    ${plumbers.map((v,i) => { vendorFrom='matched'; return vendorCard(v,i,i===0); }).join('')}
  </div>`;
}

function renderVendorDetail(v) {
  const trade = TRADES.find(t=>t.id===v.trade);
  return `<div style="padding:0 24px 100px">
    <div class="back-row"><div class="back-btn" onclick="navigate('${vendorFrom}')">‚Üê</div></div>
    <div class="card rise" style="text-align:center;padding:30px">
      <div class="avatar" style="width:60px;height:60px;font-size:18px;margin:0 auto">${initials(v.name)}</div>
      <h3 class="serif" style="font-size:22px;font-weight:600;color:#2C2C28;margin:16px 0 6px">${v.name}</h3>
      ${stars(v.rating)}
      <p style="font-size:11px;color:#9E9A90;margin:6px 0 0">${v.reviews} reviews  ¬∑  ${v.jobs} jobs completed</p>
      ${v.verified ? `<div style="margin-top:12px">${verifiedTag()}</div>` : ''}
      <p style="font-size:13px;color:#6B6860;margin:14px 0 0;line-height:1.6">${v.bio}</p>
    </div>
    <div class="rise" style="display:grid;grid-template-columns:1fr 1fr;gap:8px;margin-top:12px;animation-delay:0.06s">
      ${[{l:"Response Time",v:v.time},{l:"Price Range",v:'$'.repeat(v.price)},{l:"Distance",v:v.dist},{l:"Specialty",v:trade?trade.label:v.trade}].map(d => `
        <div class="card" style="padding:14px 16px">
          <div style="font-size:9px;color:#9E9A90;font-weight:500;text-transform:uppercase;letter-spacing:0.8px">${d.l}</div>
          <div style="font-size:15px;font-weight:500;color:#2C2C28;margin-top:4px">${d.v}</div>
        </div>`).join('')}
    </div>
    <div class="rise" style="margin-top:22px;animation-delay:0.12s">
      <h4 class="serif" style="font-size:18px;font-weight:600;color:#2C2C28;margin-bottom:14px">Recent Reviews</h4>
      ${[{name:"Sarah M.",text:"Fixed our bathroom leak in under an hour. Very professional. Would absolutely hire again.",r:5,ago:"2 weeks ago"},
         {name:"James L.",text:"Great communication and fair pricing. Explained what was wrong before starting work.",r:5,ago:"1 month ago"},
         {name:"Patricia K.",text:"Good work. Arrived a bit late but the repair quality was excellent.",r:4,ago:"2 months ago"}
      ].map(rev => `
        <div class="card" style="margin-bottom:8px;padding:16px">
          <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:6px">
            <span style="font-weight:500;font-size:12px;color:#2C2C28">${rev.name}</span>
            <span style="font-size:10px;color:#9E9A90">${rev.ago}</span>
          </div>
          ${stars(rev.r)}
          <p style="font-size:12px;color:#6B6860;line-height:1.6;margin-top:8px">${rev.text}</p>
        </div>`).join('')}
    </div>
    <div class="rise" style="margin-top:18px;display:flex;gap:8px;animation-delay:0.18s" id="vendorCTA">
      <button class="btn btn-primary" style="flex:2" onclick="requestQuote(${v.id})">Request Quote</button>
      <button class="btn btn-ghost" style="flex:1">Message</button>
    </div>
  </div>`;
}

function renderDirectory() {
  const d = dirState;
  let list = VENDORS.filter(v => d.trade === 'all' || v.trade === d.trade);
  if (d.search) {
    const q = d.search.toLowerCase();
    list = list.filter(v => v.name.toLowerCase().includes(q) || v.bio.toLowerCase().includes(q) || v.trade.includes(q));
  }
  list.sort((a,b) => d.sort==='rating'?b.rating-a.rating:d.sort==='dist'?parseFloat(a.dist)-parseFloat(b.dist):d.sort==='reviews'?b.reviews-a.reviews:a.price-b.price);

  return `<div style="padding:0 24px 100px">
    <div style="padding:22px 0 4px">
      <h2 class="serif" style="font-size:26px;font-weight:600;color:#2C2C28">Find a Professional</h2>
      <p style="font-size:12px;color:#9E9A90;margin-top:6px">Browse by trade or search directly</p>
    </div>
    <div style="position:relative;margin-top:16px;margin-bottom:14px">
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#9E9A90" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="position:absolute;left:16px;top:50%;transform:translateY(-50%)"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
      <input type="text" id="dirSearch" value="${d.search}" placeholder="Search by name, trade, or keyword..."
        oninput="dirState.search=this.value;rerenderDirectory()"
        style="width:100%;padding:14px 16px 14px 44px;border-radius:14px;border:1px solid #DBD7CE;font-size:13px;font-family:'Karla',sans-serif;color:#2C2C28;box-sizing:border-box;outline:none;background:#FFFFFF">
    </div>
    <div style="display:flex;gap:6px;overflow-x:auto;padding-bottom:4px;margin-bottom:14px">
      ${TRADES.map(t => `<span class="pill ${d.trade===t.id?'active':''}" onclick="setDirTrade('${t.id}')">${t.em} ${t.label}</span>`).join('')}
    </div>
    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:16px">
      <span style="font-size:11px;color:#9E9A90">${list.length} professional${list.length!==1?'s':''}</span>
      <div style="display:flex;gap:4px">
        ${[{id:"rating",l:"Top Rated"},{id:"dist",l:"Nearest"},{id:"reviews",l:"Reviews"},{id:"price",l:"Price"}].map(s => `
          <span style="padding:4px 10px;border-radius:8px;font-size:9px;font-weight:500;cursor:pointer;letter-spacing:0.5px;text-transform:uppercase;
            background:${d.sort===s.id?'rgba(92,107,60,0.07)':'transparent'};color:${d.sort===s.id?'#5C6B3C':'#9E9A90'}"
            onclick="setDirSort('${s.id}')">${s.l}</span>`).join('')}
      </div>
    </div>
    ${list.length === 0 ? `<div style="text-align:center;padding:48px 20px"><div style="font-size:24px;color:#C4C0B6;margin-bottom:10px">‚ú¶</div><p style="font-size:13px;font-weight:500;color:#6B6860">No results found</p><p style="font-size:11px;color:#9E9A90;margin-top:4px">Try a different search or category</p></div>` : list.map((v,i) => { return vendorCard(v,i,false); }).join('')}
  </div>`;
}

function renderIssues() {
  return `<div style="padding:0 24px 100px">
    <div style="padding:22px 0 16px"><h2 class="serif" style="font-size:26px;font-weight:600;color:#2C2C28">Issues</h2></div>
    <div style="display:flex;gap:6px;margin-bottom:18px">
      ${[{id:"all",l:"All"},{id:"pending",l:"Pending"},{id:"active",l:"Active"},{id:"done",l:"Completed"}].map(t => `<span class="pill active" style="background:${t.id==='all'?'#5C6B3C':'#FFFFFF'};color:${t.id==='all'?'#fff':'#9E9A90'};border-color:${t.id==='all'?'#5C6B3C':'#DBD7CE'}">${t.l}</span>`).join('')}
    </div>
    ${ISSUES.map((iss,i) => `
      <div class="card rise" style="margin-bottom:10px;padding:18px;animation-delay:${0.04*i}s">
        <div style="display:flex;justify-content:space-between;align-items:flex-start">
          <div>
            <span style="font-size:14px;font-weight:500;color:#2C2C28">${iss.title}</span>
            <div style="font-size:11px;color:#9E9A90;margin-top:5px">${iss.trade}  ¬∑  ${iss.date}${iss.vendor?'  ¬∑  '+iss.vendor:''}</div>
          </div>
          ${badge(iss.urgency)}
        </div>
        <div style="display:flex;justify-content:space-between;align-items:center;margin-top:12px">
          <span style="font-size:11px;color:#9E9A90">${iss.vendor?'Vendor: '+iss.vendor:'Awaiting bids...'}</span>
          <span style="font-size:9px;font-weight:500;padding:3px 10px;border-radius:100px;letter-spacing:0.5px;text-transform:uppercase;
            background:${iss.status==='done'?'rgba(90,138,94,0.08)':iss.status==='active'?'rgba(92,107,60,0.07)':'#ECE8E0'};
            color:${iss.status==='done'?'#5A8A5E':iss.status==='active'?'#5C6B3C':'#9E9A90'}">
            ${iss.status==='done'?'Completed':iss.status==='active'?'In Progress':'Pending'}
          </span>
        </div>
      </div>`).join('')}
  </div>`;
}

function renderProfile() {
  return `<div style="padding:0 24px 100px">
    <div style="padding:22px 0 20px"><h2 class="serif" style="font-size:26px;font-weight:600;color:#2C2C28">Profile</h2></div>
    <div class="card rise" style="text-align:center;padding:30px">
      <div style="width:64px;height:64px;border-radius:50%;margin:0 auto 14px;background:#5C6B3C;display:flex;align-items:center;justify-content:center;color:#fff;font-weight:600;font-size:22px">B</div>
      <h3 class="serif" style="font-size:22px;font-weight:600;color:#2C2C28;margin-bottom:4px">Brad</h3>
      <p style="font-size:11px;color:#9E9A90">Homeowner  ¬∑  Member since 2025</p>
    </div>
    <div class="rise" style="margin-top:12px;animation-delay:0.06s">
      ${[{l:"My Home",s:"1 property registered"},{l:"Payment",s:"Visa ending 4242"},{l:"Notifications",s:"Push & email enabled"},{l:"Saved Professionals",s:"3 favorited"},{l:"Help & Support",s:"FAQs, contact us"}].map(item => `
        <div class="card" style="margin-bottom:6px;padding:16px 20px;display:flex;justify-content:space-between;align-items:center">
          <div><div style="font-size:14px;font-weight:500;color:#2C2C28">${item.l}</div><div style="font-size:11px;color:#9E9A90;margin-top:3px">${item.s}</div></div>
          <span style="color:#C4C0B6;font-size:14px">‚Ä∫</span>
        </div>`).join('')}
    </div>
  </div>`;
}

// ‚îÄ‚îÄ‚îÄ NAVIGATION ‚îÄ‚îÄ‚îÄ
function navigate(screen) {
  currentScreen = screen;
  const c = content();
  c.scrollTop = 0;

  switch(screen) {
    case 'home': c.innerHTML = renderHome(); break;
    case 'scan': c.innerHTML = renderScan(); break;
    case 'diagnosis': c.innerHTML = renderDiagnosis(); break;
    case 'matched': vendorFrom = 'matched'; c.innerHTML = renderMatched(); break;
    case 'directory': vendorFrom = 'directory'; c.innerHTML = renderDirectory(); break;
    case 'issues': c.innerHTML = renderIssues(); break;
    case 'profile': c.innerHTML = renderProfile(); break;
    case 'vendorDetail': c.innerHTML = renderVendorDetail(selectedVendor); break;
  }

  // Update nav
  document.querySelectorAll('.nav-item').forEach(el => {
    el.classList.toggle('active', el.dataset.screen === screen || (screen === 'vendorDetail' && el.dataset.screen === (vendorFrom === 'directory' ? 'directory' : 'home')));
  });
}

// ‚îÄ‚îÄ‚îÄ SCAN ACTIONS ‚îÄ‚îÄ‚îÄ
function setScanMode(mode) { scanState.mode = mode; navigate('scan'); }
function resetScanMode() { scanState = { mode: null, uploaded: false, desc: '', room: 'Kitchen' }; navigate('scan'); }
function uploadPhoto() { scanState.uploaded = true; navigate('scan'); }
function setScanRoom(room) { scanState.room = room; navigate('scan'); }
function updateScanButton() {
  const btn = document.getElementById('analyzeBtn');
  if (btn) btn.disabled = !(scanState.uploaded || scanState.desc.trim().length > 10);
}

function startAnalysis() {
  const c = content();
  c.innerHTML = renderAnalyzing();
  let p = 0;
  const labels = ["Examining your input...","Analyzing the details...","Identifying the issue...","Assessing urgency...","Preparing your diagnosis..."];
  const iv = setInterval(() => {
    p += Math.random() * 14 + 4;
    if (p >= 100) { p = 100; clearInterval(iv); setTimeout(() => navigate('diagnosis'), 400); }
    p = Math.min(p, 100);
    const bar = document.getElementById('progressBar');
    const lbl = document.getElementById('progressLabel');
    if (bar) bar.style.width = p + '%';
    if (lbl) lbl.textContent = labels[Math.min(Math.floor(p/25), 4)];
  }, 280);
}

// ‚îÄ‚îÄ‚îÄ DIRECTORY ACTIONS ‚îÄ‚îÄ‚îÄ
function setDirTrade(t) { dirState.trade = t; rerenderDirectory(); }
function setDirSort(s) { dirState.sort = s; rerenderDirectory(); }
function rerenderDirectory() { content().innerHTML = renderDirectory(); }

// ‚îÄ‚îÄ‚îÄ VENDOR ACTIONS ‚îÄ‚îÄ‚îÄ
function showVendorDetail(id) {
  selectedVendor = VENDORS.find(v => v.id === id);
  navigate('vendorDetail');
}
function requestQuote(id) {
  const v = VENDORS.find(x => x.id === id);
  const cta = document.getElementById('vendorCTA');
  if (cta && v) {
    cta.innerHTML = `<div style="width:100%;background:rgba(92,107,60,0.07);border:1px solid rgba(92,107,60,0.14);border-radius:14px;padding:20px;text-align:center">
      <div style="font-size:14px;font-weight:600;color:#5C6B3C;margin-bottom:6px">‚úì  Quote Requested</div>
      <p style="font-size:12px;color:#6B6860;line-height:1.5">${v.name} typically responds within ${v.time}. We'll notify you when they reply.</p>
    </div>`;
  }
}

// ‚îÄ‚îÄ‚îÄ INIT ‚îÄ‚îÄ‚îÄ
navigate('home');
</script>
</body>
</html>
